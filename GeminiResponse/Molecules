import React, { InputHTMLAttributes } from 'react';
import { Input, Label, Tooltip, Icon } from '../atoms'; // Assumindo que exporta Icon e Tooltip de atoms

interface InputFieldProps extends InputHTMLAttributes<HTMLInputElement> {
  label: string;
  id: string; // ID é obrigatório para acessibilidade do Label
  error?: string | null | boolean; // Aceita string (mensagem) ou boolean
  helperText?: string;
  tooltip?: string;
  fullWidth?: boolean;
  leftIcon?: React.ReactNode;
  rightIcon?: React.ReactNode;
}

export function InputField({ 
  label, 
  id, 
  error, 
  helperText, 
  tooltip,
  className = '',
  fullWidth = true,
  ...inputProps 
}: InputFieldProps) {
  
  // Determina se há uma mensagem de erro em string para exibir
  const errorMessage = typeof error === 'string' ? error : undefined;
  // Booleano para estado do input
  const hasError = !!error;

  return (
    <div className={`flex flex-col ${fullWidth ? 'w-full' : ''} ${className}`}>
      {/* Label Row com Tooltip opcional */}
      <div className="flex items-center gap-1.5 mb-1.5">
        <Label htmlFor={id} className="!mb-0 cursor-pointer">
          {label}
        </Label>
        
        {tooltip && (
          <Tooltip content={tooltip}>
             <span className="text-olive-400 hover:text-sage-600 transition-colors cursor-help inline-flex">
                <Icon name="info" size="sm" />
             </span>
          </Tooltip>
        )}
      </div>
      
      {/* Input Component */}
      <Input 
        id={id} 
        error={hasError}
        aria-invalid={hasError}
        aria-describedby={errorMessage ? `${id}-error` : helperText ? `${id}-helper` : undefined}
        fullWidth={fullWidth}
        {...inputProps} 
      />
      
      {/* Feedback (Error or Helper) */}
      <div className="min-h-[20px] mt-1.5">
        {errorMessage ? (
          <span 
            id={`${id}-error`} 
            className="text-sm text-status-error flex items-center gap-1 animate-slide-down font-medium"
          >
            <Icon name="error" size="sm" className="shrink-0" />
            {errorMessage}
          </span>
        ) : helperText ? (
          <span 
            id={`${id}-helper`} 
            className="text-xs text-olive-500"
          >
            {helperText}
          </span>
        ) : null}
      </div>
    </div>
  );
}